---
title: |
  ![](framsida.png)
output: pdf_document
latex_engine: lualatex
number_sections: true
linestretch: 1.5
mainfont: Times New Roman
fontsize: 12pt
---

```{r, echo=FALSE, results='hide', message=FALSE, warning=FALSE}

#Data management

PKGs = c("tidyverse","dplyr","readxl","ggplot2","dbplyr","zoo","lubridate","broom","tseries",
         "quantmod","tframePlus","magrittr","tidyr","ggfortify","mFilter","KFAS","xts","aTSA",
         "dynlm","tinytex","latexpdf","MSwM","strucchange","methods","stats","knitr",
         "rmarkdown","utf8", "knitr", "kableExtra")

lapply(PKGs, library, character.only = TRUE, quietly = TRUE)

#Importing and checking data set

Data1 = read.csv(url(
  "https://raw.githubusercontent.com/Daniel-Svanholm/main/Main/data1.csv"))

#Creating inflation and output gap variables
Data2 = mutate(Data1, inf_gap = (core_inf - inf_target))

HP = hpfilter(Data2[,5], freq=1600)

Data3 = cbind(Data2, HP$trend)

Data3 = mutate(Data3, output_gap = 100*log(gdp_real / HP$trend))

Data3 = subset(Data3, select = 
                 -c(HP$trend, gdp_delta, gdp_real, inf_target, core_inf))
Data4 = subset(Data3, select = 
                 c(date, IR3T_geomean, inf_gap, output_gap, HUF_60_geomean))

#Creating REER gap
HP1 = hpfilter(Data4[,5], freq=1600)

Data5 = cbind(Data4, HP1$trend)

Data5 = mutate(Data5, REER_gap = 100*log(HUF_60_geomean / HP1$trend))

Data5 = subset(Data5, select = -c(HP1$trend))
Data5 = subset(Data5, select = 
                 c(date, IR3T_geomean, inf_gap, output_gap, REER_gap))

#Autoregressive Markov Switching Model

#new data set
Data_HMM = as.data.frame(Data5)

#First order difference
Data_HMM$diff_IR3T = c(0, diff(Data_HMM$IR3T_geomean))

Data_HMM = (subset(Data_HMM, select = c(diff_IR3T, inf_gap, output_gap, REER_gap)))

#As time series
Data_HMM_ts = as.ts(Data_HMM)

HMM2 = lm(diff_IR3T ~ -1 + inf_gap + output_gap + REER_gap, data = Data_HMM_ts, na.action=na.exclude)

#HMM fitted with interest rate smoothing
model_HMM1 = msmFit(HMM2, k = 2, sw = c(T,T,T,F,T), p = 1)

#State-Space Model

#New data set for SSM
Data_SSM = as.data.frame(Data5)

Data_SSM_xts = xts(Data_SSM, order.by = as.Date(Data_SSM$date))

#Defining variables
y = ts(as.vector(as.numeric(Data_SSM_xts$IR3T_geomean)))

x1 = ts(as.numeric(Data_SSM_xts$inf_gap))
x2 = ts(as.numeric(Data_SSM_xts$output_gap))
x3 = ts(as.numeric(Data_SSM_xts$REER_gap))

#Model estimation and specification
model1 = SSModel(y ~ -1 + SSMregression(~ x1 + x2 + x3, type = "common", Q=(diag(1, nrow=3, ncol=3))))

smooth_states = coef(model1, states = "regression")

#Confirming model
is.SSModel(model1)

#Alternative coefficient extraction (same results)
out_model1 = KFS(model1, smoothing = c("state", "mean", "disturbance"))

smooth_kfs = coef(out_model1, states = "regression")

#Removing atomic vectors
smooth_states1 = as.data.frame(smooth_states)

#Extracting residuals from the smooth states

#Normal state residuals
res_outmodel = residuals(out_model1, type = c("state"))
mse = mean(res_outmodel^2)

#Computing RMSE traditional way
rmse = sqrt(mse)

#Constructing confidence intervals
up_x1 = (smooth_states1[,1] + (2*rmse))
low_x1 = (smooth_states1[,1] - (2*rmse))

up_x2 = (smooth_states1[,2] + (2*rmse))
low_x2 = (smooth_states1[,2] - (2*rmse))

up_x3 = (smooth_states1[,3] + (2*rmse))
low_x3 = (smooth_states1[,3] - (2*rmse))

#Preparing graphs for states with CIs
state_CIs1 = as.data.frame(cbind(smooth_states1[,1], up_x1, low_x1))
state_CIs2 = as.data.frame(cbind(smooth_states1[,2], up_x2, low_x2))
state_CIs3 = as.data.frame(cbind(smooth_states1[,3], up_x3, low_x3))

coint.test(Data5$IR3T_geomean, Data1$core_inf)
```

# Abstract.

This thesis demonstrates how a Taylor rule could capture the monetary policy decision process with imperfect information. The changes in the weights present in the rule reflect policy regime shifts. This framework is suitable in studying a small open transitional economy such as Hungary in recent years. This thesis employs the State-Space model which may capture the time-varying weights in the Taylor rule and an Autoregressive Hidden Markov Model which may identify unobservable or hidden underlying regimes using structural breaks. This thesis employs a sample period from 2000Q1-2020Q2, which finds that an active monetary policy regime transitions to a passive regime which becomes dominant in the second half of the sample, namely from 2014Q1 onward. Additionally, evidence of ineffective monetary policy is found. As general evidence, this thesis finds support for the Taylor rule constructed through the partial use of intermediate policy targets such as the real effective exchange rate. Which becomes ineffective towards the end of the sample, as the nominal interest rate degrades from two percent towards the zero lower bound. 

\newpage{}

\tableofcontents{}

\newpage{}

# 1 Introduction.

Macroeconomic stability is historically not commonly associated with central European economies, the most obvious being the inflationary example of the Weimar Republic of Germany during the interwar years. Continental and especially Central/Eastern Europe has been the melting pot for important economic and political events throughout the twentieth century. Two world wars and powerful clashes between political and economic systems have rocked the macroeconomic stability of emerging economies in Central Europe and helped shape what can be observed today. 

One significant part of the rapidly growing emerging economies in central Europe is Hungary, the third largest of the Visegrad Group (or V4). A nation which suffered tremendously due to the Trianon Treaty, losing nearly 75% of its territories, more than half its populace and forced to pay massive reparations to foreign powers during the first half of the century (Britannica, 2020). The following decades of Soviet occupation after the Axis defeat in 1945, which stripped the country of its resources, decimated its infrastructure and instituted heavy industries with no regard for domestic Hungarian needs or suitability for production. After the revolution of 1956 Hungary slowly regained its independence and began market and economic reforms, including restructuring of the banking system, which would not gain any real effect until the 1980s. However, the spirit of economic development continued with increased privatizations, initiatives for voluntary export and trade with Hungary's neighbours and new found post war allies. 

With low output growth and high inflation being present for the majority of the post revolutionary Hungarian republic, the importance of trade and economic aid, with guidance for economic development was essential. Transitioning from a planned economy to a market economy aided in providing the means of remedying the problems created by the former. Since the introduction of further economic policies in the 1980s, the GDP growth per capita in Hungary increased significantly, with gradual disinflation to accompany it. 

\newpage{}
Obviously, the restructuring of the Hungarian economy has proved successful compared to the previous predicament of reversed flow of output growth and price levels. This creates an opportunity to descriptively explore how this gradual successful transition was achieved, through regime oriented economic theory and application. Not only for the advancement of understanding the particular situation of Hungary, but to further generate knowledge that may aid the development of other economies in similar or comparable stages of development today or in the future. 

During the early 2000s, the central bank of Hungary (Magyar Nemzeti Bank or MNB) enjoyed a dual goal of maintaining price stability along a semi-fixed exchange rate to the Euro, with inflation targeting adopted in 2001 (MNB, 2020). However, in 2008 the MNB and the Hungarian government elected to let the exchange rate float, in favour of only maintaining price stability by explicit inflation targeting (MNB, 2020). It was also decided that management of the exchange rate is to be in accordance with both the government and the monetary council presiding over MNB. This commitment to price stability provides a point of inquiry examining how regimes with potential implicit goals of monetary policy by the MNB can be detected. Considering that potential conflicting aspects of monetary policy parameters may impact differing unobservable or hidden regimes/regime shifts to be identified.

## 1,1 Problem statement.
 
The feasible goals of monetary authorities is usually characterized by macroeconomic stability at or close to desired levels of inflation, output and unemployment among other important variables. Aside from the long run equilibrium of economic theory, these indicators are rarely at the desired levels of the monetary authorities in the economy and become more complicated as international trade impacts the stability of individual economies. Macroeconomic instability is therefore an important point of study both in evaluation of monetary policy regimes ex post in order to evaluate its real effects contra the desired effect in an effort to improve future macroeconomic stability in both developed and emerging economies which may employ similar instruments and/or goals. 

The economist John B Taylor (Taylor, 1993) attempted to describe how monetary authorities could achieve macroeconomic stability for a closed economy, with considerations to a set of minimalist economic indicators measured ex post. These indicators assume that the monetary authorities practices active monitoring of domestic economic conditions and employs some degree of inflation targeting. Creating a simple rule for monetary authorities to determine the level of the nominal interest rate, which Taylor perceived as the main instrument of monetary authorities for regulating and achieving macroeconomic stability. 

Below is the traditional Taylor rule constructed by Taylor in 1993, without a lagged nominal interest rate which were added in his 1999 revision.

| $i_{t} = r + a(\pi_{t} - \pi^{*}) + b(y_{t} - y^{*})$ \hfill{(eq I)}

The weights proposed by Taylor $(a)$ and $(b)$ originally equal $0,5$ but were reevaluated in an attempt to prove that given an objective function of the central bank, the rule is actually an optimal one (weights now equal to $(a=1,5)$ and $(b=1)$, Taylor, 1999). This reexamination also provided what became known as the Taylor principle; employing a weight of $(a>1)$ will stabilize the macroeconomy with a more than one-to-one ratio of the nominal interest rate, creating a rise in the real interest rate dampening inflationary tendencies and slowing the economy (Ibid). Sizes of empirically estimated weights would indicate how active a given regime is in this framework. 

Since Taylors original publication, criticism regarding potential underlying regimes and assumptions of application of Taylor type monetary policy rules have been debated. Different regimes may exist set on prioritizing one macroeconomic variable present in the Taylor/monetary policy rules, e.g. preferences for output targeting alongside price stability targeting (recession avoidance) may contradict the explicit policy goal. 

## 1,2 Purpose.

This rule provides the outset from which this thesis aims to describe the modern historical monetary policies enacted by the MNB for the purpose of achieving its defined objective by the use of a modified rendition of the Taylor rule ex post. Expanding the traditional Taylor rule to capture additional macroeconomic factors determinant in explaining past regimes/regime shifts of monetary policy by the MNB. To augment and expand previous research in the field with additional data and estimates through a regime oriented methodology and empirical discussion, including the abnormal situation now facing many economies with ineffective monetary policy. Lastly, it aims to identify and describe a Hidden Markov Model that describes regimes and regime shifts in monetary policy in Hungary during the sample period ex post.

## 1,3 Research question:
 
*Given the stated objective of monetary policy established by the central bank of Hungary and the efforts exhausted to obtain that objective, is it possible using an extended rendition of the Taylor rule to accurately describe regimes/regime shifts of monetary policy ex post?*

The sample period examined ranges from the year 2000 quarter one until 2020 quarter two, with data corresponding to eighty two observations per variable vector. Thus, the sample period envelops both the global events of The Great Recession (plagued by low inflation and risk of deflation) and partially the lockdowns of 2019-2020. Representing two immensely important time periods in the forum of economics and financial analysis respectively. 

\newpage{}

# 2 Literature Review.

Applications of Taylor type rules in small open economies typically benefit from expansion of the original Taylor rule. Both Österholm (2005), Balabay (2011) and Tarkhan-Mouravi (2009) apply the real effective exchange rate as a weighted index to extend the reaction function of the monetary policy transmission mechanism. This addition is further supported by the theoretical estimation exercise conducted by Svensson (2000), which finds that the transmission mechanism of the interest rate is greatly significant in affecting the real effective exchange rate in Taylor type rules. Frömmel and Schobert (2006) finds that emerging economies in former soviet Eastern Europe exhibit a “fear of floating”, with evidence of both explicit and implicit exchange rate targeting with either none or contradictory monetary policy goals. Emphasizing the importance of exchange rate policy shifts in monetary policy during sample periods. 

Application in a UK study, Nelson (2001) considered the Taylor rule performance during the period ex ante and ex post ERM, with support for the Taylor rule after emergence from ERM effectively moving from exchange rate targeting to inflation targeting. Christiano and Rostagno (2001) finds that not only does estimated Taylor type rules show signs of non-linearity, but also the possibility for multiple equilibria. Conditional on the current inflation (unique equilibria) or future inflation (multiple equilibria) is used for measurement. The multiple equilibria argument is supported by Benhabib, Schmitt-Grohe and Uribe (1999), emphasizing both model specification concerns and possible misinterpretation by economists. Benhabib, Schmitt-Grohe and Uribe exemplifies this by describing attempts made to estimate a slope of inflation around a steady state in the area which monetary policy is active, leading to a conclusion that monetary policy has always been active despite underlying evidence to the contrary.

Woodford (2001) argues that the output gap itself may not be linear and that using the detrended output for estimation of the output gap provides a poor explanatory account of inflation. Alternatively, Woodford argues that usage of the marginal cost of real unit labour, as the cost price ratio determines deadweight loss and incentives to raise prices, possess significant explanatory power of medium frequency variation in inflation. 
\newpage{}
In contrast Judd, Rudebusch (1998) follows a similar construction of the potential output component of the output gap as the US federal reserve, with a time-varying natural rate of unemployment (NAIRU) in the context of a Phillips curve. Assuming a structural approach considering the output gap and its relationship with future inflation. Orphanides (2002 & 2003) considers the GDP deflator used by Taylor (1993) as an inappropriate measure of inflation, since such information is unavailable to policy makers ex ante. Orphanides also offers a growth rule alternative to the traditional Taylor type rule, targeting “growth” of nominal income. Avoiding the pitfalls of natural-rate-gap policies, relying on the lagged value of the interest rate instrument for policy adjustment $(\Delta i)$ rather than $(i)$. Cukierman (2008) highlights the risk of preferences of positive versus negative gaps of inflation and output to the monetary authorities.  

Other approaches regarding the interest rate in Taylor type rules are examined by Svensson (2000 & 2003), Nelson (2001), Frömmel and Schobert (2006) who employ interest rate smoothing, central banks maintain momentum when adjusting monetary policy. However, there is no consensus in this issue. Similar objections to traditional specifications are raised by Gerlach-Kristen (2003) regarding a possibly non constant inflation target. Suggesting that if the basis for the inflation target is rooted in the expectation hypothesis, the target assumption is not empirically valid. 

Gerlach-Kristen (2003) show that traditional Taylor rules forecast poorly out of sample, presenting an alternative estimation with explicit considerations to non-stationarity. Orphanides (2002 & 2003) is concerned with both the information set available to monetary policy makers, as accurate “current” information is not available until ex post. Orphanides exemplifies the definitions of “potential” and “normal" as significant to policy makers given the information available ex ante versus ex post, when implementing monetary policy. Clarida, Gali, Gertler (1998) using a GMM estimation finds that the Bundesbank responds to anticipated inflation rather than lagged, supporting central bank forward-looking behaviour. It is also supported in the Euro area by Gerlach, Kristen (2003) who finds that using the real interest rate in the short run captures the long run relationship more appropriately, again suggesting a forward-looking central bank. 
\newpage{}
Svensson (2003) examines both forward and backward-looking models of Taylor type rules, finding support for both types of perspectives dependent on the specific rule used (instrument or targeting rule). 

Christiano and Rostagno (2001) emphasizes through a cash-credit model the importance of fiscal policy in relation to monetary policy, with descriptions of household, firms, monetary and fiscal authorities. They argue, that as governments must maintain solvency on government debt but not liabilities, as a liquidity trap cannot constitute an equilibrium outcome in monetary policy. Nelson (2001) likewise examines the complementation of fiscal and monetary policies, where income policies, food subsidies and cuts in indirect taxation are considered in attempts to control inflation during the ERM period of the UK. 

Orphanides (2003) finds that reduced monetary policy activism has been consistent with more preferable outcomes since the Great Inflation, with some support from Svensson (2000) who argues that flexible inflation targeting is more effective and provides less room for activism compared to strict inflation targeting. Benhabib, Schmitt-Grohe and Uribe (1999) finds that active monetary policy near the inflation target increases risk of deflation, compared to passive monetary policy through e.g. interest rate or exchange rate peg. 

Regime shifting models are common when examining relationships between monetary policy parameters. Hoshikawa (2011), employs a regime shifting model to examine Japanese foreign exchange policy, finding a long term relationship between foreign currency reserves and the YEN/USD exchange rate. Reschreiter (2010) finds that a monetary policy regime shift from exchange rate targeting to inflation targeting through the real interest rate occurs in the UK, after the exit from ERM with a time-varying mean-reverting framework. Ibrahim Arısoy (2013) instead uses the Kalman filter for regime shifts using the Fisher equation in Turkey, with limited support for the Fisher hypothesis.

\newpage{}

# 3 Theoretical Framework.

This section aims to describe and discuss the theoretical aspects of monetary policy and what parameters might contribute to changes in monetary policy regimes. Based on the framework developed by Friedman and Keynes respectively, as described by Sorensen & Jacobsen (2010). 

## 3,1 Capital mobility and nominal interest rate parity.

In an open economy with interactive capital and goods markets, any arbitrage opportunities presented by differing yields of assets will generate capital mobility. This would be problematic since large in and outflows of capital will affect output and inflation in both sender and recipient countries respectively. Given that capital mobility is perfect, nominal interest rates of open economies must present equal yields for such arbitrage opportunities to be rare or non existent, this can be formalized by the following condition known as the uncovered interest rate parity (UIP):

| $(1 + i) = (1+i^{f})(\frac{E^{e}_{+1}}E)$ \hfill{(eq I)}

Where $(i) =$ the domestic nominal interest rate, $(i^{f}) =$ the foreign nominal interest rate, $(E)$ = nominal exchange rate and $(E^{e}) =$ nominal exchange rate expected to prevail in the next period. 

This conditions states that an investor can either invest domestically and earn $(1 + i)$ amount of wealth in the current period (ignoring Fx forwards) or alternatively purchase $(\frac{1}E)$ units of foreign currency giving an amount of wealth equal to $(\frac{1}E)(1+i^{f})$ in foreign currency. In simple terms, foreign and domestic investments must yield the same end-of-period wealth and thus have the same expected rate of return.

Taking the logs of both sides of this condition, where $(ln x \approx x)$ gives the approximate condition of:

| $i = i^{f} + \overline{e}_{+1} - e$  -> $\overline{e}_{+1} = ln \overline{E}_{+1}$ \hfill{(eq II, III)}

The first equation shows that if the domestic currency is expected to depreciate in the next period, the domestic nominal interest must rise to maintain interest rate parity. This would of course imply that the central bank defends a fixed exchange rate. However, by allowing the domestic exchange rate to adjust to differences in the nominal interest rate, parity can be maintained with capital mobility with the central bank setting the nominal interest rate according to other monetary goals.

Assuming that small open economies maintain inflation targets similar to each other to achieve macroeconomic stability and successfully attain this goal in the long term, it can be postulated that:

| $\pi^{*} = \pi^{f}$ ->  $\Delta e = e - e_{-1}$ \hfill{(eq IV, V)}

The nominal exchange rate itself cannot serve as a nominal anchor for inflation given an open economy, but interest rate parity CAN be maintained by allowing the exchange rate to adjust. And by maintaining domestic inflation equal or close to foreign inflation the nominal exchange rate can remain stable. This means that appreciation and depreciation between currencies can be kept stable and minimize large changes in net-export. 

## 3,2 The AS-AD framework.

Assuming that the central bank sets its nominal interest rate in advance of observed shocks, is aware of the existence of an AD function which include demand shocks, where said shocks cannot be observed directly and that the monetary policy regime does not attempt to obtain output levels above the natural rate. A domestic goods market equilibrium that can be represented by:

| $(y_{t+1} - \overline{y}) = z_{t+1} - a_{2}(i_{t} - \pi_{t} - \overline{r}^{*})$ \hfill{(eq VI)}

Where $(z_{t+1})$ contains unobservable demand shocks for the next period, $(i) =$ nominal interest rate and $(\overline{r}^{*}) =$ risk free steady-state real interest rate. This also implicitly assumes that the central bank has a structural understanding of the open economy in question and that expectations are static (backward-looking). Furthermore, the AS function is given by:

| $\pi_{t+1} = \pi_{t} + \gamma(y_{t} - \overline{y}) + S_{t+1}$ \hfill{(eq VII)}

With the term $(S_{t+2})$ containing supply shocks for future periods.

Given this model for market equilibrium in conjunction with the UIP means that monetary policy regimes will have to satisfy both equilibrium conditions in the long run for any regime to be stable. For the goods market equilibrium to hold for an small open economy, any differences in future and natural output has to be balanced by either net-export or financial flows such as savings and investments, which is then affected by the UIP condition.

Consider an open economy with perfect capital mobility and with a central bank that pursue a fixed exchange rate regime. This encompasses several types of monetary policy regimes ranging from a completely fixed nominal exchange rate (or hard peg) to a relatively flexible exchange rate bandwidth (soft peg).

Given the UIP (I) described above fixing the nominal exchange rate would imply that:

| $e^{e+1} - e = 0$ thus $i = i^{f}$

And the real exchange rate is given by:

| $E^{r} = (\frac{EP^{f}} P)$ \hfill{(eq VIII)}

Implies that the change in the real exchange rate is given by:

| $(e^{r} - e^{r_{-1}}) = (\pi^{f} - \pi)$ \hfill{(eq IX)}

| $e^{r} = ln E^{r}$    $\pi^{f} = (ln P^{f} - ln P^{f{-1}}) = (ln P - ln P_{-1})$ \hfill{(eq X)}

Domestic inflation must then correspond to foreign inflation if the real exchange rate is to remain stable in the long term equilibrium. Any domestic inflation deviation from foreign inflation will be reflected in the real exchange rate forcing a response from the central bank. Which must, in order to defend the fixed exchange rate, adjust its nominal interest rate. Should the central bank allow the domestic nominal interest rate to be below the foreign nominal interest rate, it would need to deplete its own foreign currency reserves to combat the outflow of capital when investors sell massive amounts of domestic currency and purchase foreign currency which the central bank must facilitate. 

Should the domestic nominal interest rate be higher than the foreign nominal interest rate, it would result in a massive inflow of capital and domestic inflationary pressure with a rising nominal exchange rate. Regardless of what type of fixed/bandwidth exchange rate regime is adopted, the central bank can no longer pursue independent monetary policy to regulate the domestic economy without considering the effects on the domestic nominal exchange rate. If this monetary policy regime is credible to agents in the market any expected and actual change in the exchange rate is expected to be equal to zero.

By implementing the fixed nominal exchange rate and assuming the ordinary wage rigidity associated with the long run equilibrium into a more complex AD function for a small open economy (see Sorensen & Jacobsen (2010) for complete derivation) implies:

| $(y - \overline{y}) = \beta_{1}(e^{r_{-1}} + \pi^{f} - \pi) - \beta_{2}(i^{f} - \pi^{e_{+1}} - r^{f}) + \overline{z}$ \hfill{(eq XI)}

| It is also important to note that:

| $e^{r_{-1}} + (\pi^{f} - \pi) = e^{r_{t}}$ \hfill{(eq XII)}

Since it is assumed that the regime is credible, the impact on $(\beta1)$ is naturally $(e^r)$ alone since the difference in inflation must be equal to zero. This implies that domestic producers output measured by the real exchange rate fluctuates positively with aggregate demand. 

Inflation expectations $(e^e)$ originate principally from two perspectives: one which treats expectations as static and one which treats expectations as weakly rational (forward-looking). Neither is considered to be dominant in a theoretical setting and for the purpose of the model in treating inflation expectations, it is prudent to formalize the idea that monetary policy is credible to the majority of agents that domestic inflation is expected to follow foreign inflation that will act as an informal inflation target.

| $\pi^{e} = \pi^{f} = \pi^{e_{+1}}$ \hfill{(eq XIII)}

With this regime the central bank is constrained and cannot regulate domestic inflation other than anchoring its nominal exchange rate to a low-inflation currency, also known as “importing” inflation, which could be expressed as an intermediate targeting regime. The domestic economy is now susceptible to nominal shocks in the form of foreign inflation of which the domestic central bank cannot address without harming its own credibility. The domestic economy is also at the mercy of previously mentioned speculative attacks. Should however, the assumption of perfect capital mobility be relaxed and instead assume capital controls, i.e. capital in and outflows are regulated. Using the nominal exchange rate as an anchor becomes a possibility, as capital flows no longer require the central bank to exhaust its foreign currency reserves in the event of nominal interest rate disparity. Additionally, by keeping the nominal exchange rate fixed international trade could benefit as calculations and contracts would be simplified and be perceived as more secure for future transactions. It should be noted that implementation and maintaining of capital controls is cumbersome with significant economic costs in practice. 

Consider instead that the central bank pursues a free floating regime allowing independent monetary policy. Assuming monetary policy is aimed at inflation targeting, agents in the market would perceive that the inflation target will be equal to the average inflation rate in the long term. Note the similarity of the assumption compared to the credible commitment to a fixed nominal exchange rate. We can formulate these expectations as:

| $\pi^{e_{+1}} = \pi^{e} = \pi^{f} = \pi^{*}$ \hfill{(eq XIV)}

Which comprehensively describes the link of the central banks inflation target and its credibility to the expectations of weakly rational agents in the market. In the absence of a credible fixed exchange rate target, agents will form new expectations regarding the level of the real exchange rate. Since they cannot forecast this accurately, their expectations will be static in nature. If the exchange rate is perceived by agents as deviating in either direction, it will normalize to the perceived normal level:

| $(e^{e_{t+1}} - e_{t}) = \theta (\overline{e}_{t} - e_{t})$  $\theta> 0$ \hfill{(eq XV)}

Approximating the agents expectations on the latest observations and rewriting the previous equation:

| $\overline{e}_{t} = (e_{t-1} e^{e_{+1}} - e) = \theta - (e-e_{-1})$ \hfill{(eq XVI)}

It follows from the UIP (eq I) that:

| $\Delta e = (e - e_{-1}) = - \theta^{-1} (i - i^{f})$ \hfill{(eq XVII)}

Combining the UIP and static expectations of agents gives a modified AD function:

| $(y - \overline{y}) = \beta_{1}(e^{r}_{_-1} - \theta^{-1} (i- i^{f}) + \pi^{f} - \pi) + \beta_{2}(i - i^{f} + r^{f} - \overline{r}^{f}) + \overline{z}$ \hfill{(eq XVIII)}

| $-\theta^{-1}(i - i^{f}) =$ exchange rate channel  $(i - i^{f}) =$ interest rate channel

Note that monetary policy will affect the AD function through two different channels under this regime. The exchange rate channel will respond to changes in the nominal interest rate between domestic and foreign currencies, affecting competitiveness and net exports. The interest rate channel affects private investment and consumption. 

Continuing with the assumption that the central bank actively pursues an inflation target, it follows that given:

| $\pi^{*} = \pi^{f}$ and $\pi^{e_{+1}} = \pi^{e} = \pi^{*} = \pi^{f}$ -> $i = r^{f} + \pi^{f} + h(\pi - \pi^{f})$ -> $i - i^{f} = h(\pi - \pi^{f})$ \hfill{(eq XIX)}

Substituting into and rearranging the AD function gives:

| $(y - \overline{y}) = \beta_{1}e^{r_{-1}} - \hat{\beta}_{1}(\pi - \pi^{f}) + \overline{z}$ \hfill{(eq XXII)}

| $\hat{\beta}_{1} = \beta_{1} + h(\beta_{2} + \theta^{-1}\beta_{1})$ \hfill{(eq XXIII)}

| $\overline{z} = \beta_{2}(r^{f}-\overline{r}^{f}) + \beta_{3}(g-\overline{g}) + \beta_{4}(y^{f}-\overline{y}^{f}) + \beta_{5}(ln\epsilon - ln\overline{\epsilon})$ \hfill{(eq XXIV)}

Superficially, both exchange rate regimes exhibit the same AD function. Nonetheless, several important underlying differences need to be considered. 

Assuming a flexible regime, an active monetary policy regime can theoretically considerably dampen supply shocks with with some fluctuations in output. Demand shocks can theoretically be significantly dampened to keep output and domestic inflation reasonably stable. For a fixed regime, with finite foreign currency reserves logic would suggest a currency peg with a stable low inflation economy. The specific goal, observed outcome and instruments of monetary policy should dictate the choice of monetary policy regime, its degree of activity or passivity and the specific instrument parameter may also impact what type of monetary policy regime is in effect. 

## 3,3 Central bank loss function with limited information.

Similar to the assumptions of the central bank in the AS-AD framework, the knowledge of the central bank is limited and both demand and supply shocks cannot be forecast or observed directly (referred to as the inside lag). Thus, expected values and covariances of shocks will be zero and be independently distributed. Given that the central bank is independent and has been given the goal of maintaining price stability through an inflation target $(\pi^{*})$. The central bank thus has no real preferences outside its given goal of inflation targeting. Due to the delayed response of monetary policy (the outside lag) on real macroeconomic variables, the central bank sets nominal interest rate policy in advance so as to minimize any loss in future periods with the exact period depending on the time horizon of monetary policy (usually two years). The social loss function for period $(j)$ to minimize can be theorized as:

| $SL_{j} = \frac{1}2 (\pi_{j} - \pi^{*})^{2}$ \hfill{(eq XXV)}

By employing equations VI and VII it is possible to discern the effect when only minimizing inflation in the social loss function. Given that time indexes move forward in both equations:

| $\pi_{t+2} = \pi_{t+1} + \gamma(y_{t+1} - \overline{y}) + S_{t+2}$ \hfill{(eq XXVI)}

For a central bank only concerned with inflation given their objective, loss function and inability to observe shocks at time $(t)$ in equation XIV, the best inflationary forecast reduces to: 

| $\pi^{e}_{t+2,t} = \pi_{t} + \gamma(y_{t} - \overline{y}) - \gamma a{2}({i_{t} - \pi_{t} - \overline{r}^{*}})$ \hfill{(eq XXVII)}

Where $(\pi^{e}_{t+2,t})$ is the forecasted inflation for two or more periods ahead by the central bank. The output gap is present in calculating future inflation, it bears no weight in the social loss function as the central bank retains a single objective when minimizing its loss function. As perfect information is not available, the central bank is subject to changes in the economic structure when minimizing its loss function which may contribute to regime switches as new information becomes available. This also applies to what parameters are included in forecasting the future inflation, which will impact policy instrument choice and thus regime. An active/passive regime targeting e.g. the exchange rate or inflation may transition if the regime goal necessitates it and/or information allows it. 

## 3,4 The Taylor Rule and the Lucas critique.

Since Taylor's contribution of the popular monetary policy rule, possible revisions and criticism have produced debate regarding specifications, practical implementation of Taylor rule estimations and assumptions made. Economists have debated whether the weights should be determined differently and with what magnitude. E.g. a conservative central bank would put a larger weight on the inflation gap than on the output gap, signaling a more strict inflation targeting monetary policy regime. In its original form the rule is static, with previous inflation serving as expected inflation for the coming time period. Taylors original paper also discusses the case of a fixed exchange rate regime with a Taylor rule, under which a “world” nominal rate would be needed, since monetary policy is no longer independent and inflation targeting is not viable. 

The critique by Lucas (1976) argues that structural models of macroeconomics may be misleading, when parameters of the models fail to capture changing underlying factors. The simplicity of models such as the Taylor rule and relying on historical data, may provide misleading outcomes if changes in the microfoundations are ignored. Agents expectations and behaviour is unlikely to remain unaltered if and when policy change/become less active. Expectations of inflation and economic conditions by agents will impact policy and implicitly the outcome the model will produce vis a vis the reality (accuracy of forecasts). The principal of Lucas' argument is related to the fact that parameters in the model may implicitly depend on the policy regime at the time of measurement (Lucas, 1976). 

\newpage{}

# 4 Methodologies & Data.

## 4,1 Time-varying state-space model.

A generalized state-space model can be described as a dynamic system of equations, one describing the state of the system and one describing observations associated with that system (Durbin and Koopman, 2014). The unobserved/hidden state vector and the observable vector are separate and evolve independently, meaning observations of the system do not influence the state of said system at any point in time. More precisely, observation variables at time $(t)$ are independent of and do not influence the entire state system given the state variables at time $(t)$, but depend on the state of the system in question. 

The variables of the state equation are assumed to evolve according to a markovian process, where observations of the state system contain “noise” distorting measurements in terms of errors. By observing the visible and relevant stochastic processes of observable variables, it is possible to make inference of the properties of the state variable based on the observed knowledge of the observed outcome variables which are linearly dependent on the state variables. 

A simple time varying state-space model can be formalized in the following way, with $(M)$ state variables and $(N)$ observable variables:

| $y_{t} = Ax_{t} + Bv_{t}$       Observation equation
| $x_{t} = Cx_{t-1} + Dw_{t}$     State equation

The observation equation displays the observable vector $(y_{t})$ measured as a function of both the unobserved variable $(x_{t})$ as well as an error term, note that the measurement of variable $(y_{t})$ is “noisy” given the error term. It is assumed that $(x_{t})$ follows a random walk with no seasonal present, this implies that $(y_{t})$ and $(x_{t})$ distributions are dependent on $(t)$. Should this process be stationary, the solution would be straight forward analytically. 
The state question shows that the state of the system is dependent on its previous state as well as a stochastic process of $(w_{t})$, where the state variable is assumed to follow an $AR(p)$ process. The coefficients of $(A)$ and $(B)$ are fixed system matrices of order $(N \times m)$ and $(N \times r)$, where $r =$ the dimensions of the disturbance vector in the observation equation. In a multivariate setting such as this paper, the system matrix $(A)$ contains the independent variables.

Furthermore, the coefficients of $(C)$ and $(D)$ are also fixed system matrices of order $(m \times m)$ and $(N \times g)$, where again $(g) =$ the dimensions of the disturbance vector in the state equation. The error terms $(v_{t}$ and $w_{t})$ are assumed to be serially uncorrelated over time, with means of zero and with independent and unknown covariance matrices. Where $(v_{t})$ and $(w_{t})$ are $(r \times 1)$ and $(g \times 1)$ vectors respectively. Furthermore, it is assumed that $(B,C,D,v,w)$ are unknown and need to be estimated. For the purpose of simplicity and derivation of the recursive procedure here, the errors are assumed to be normally distributed. Since the purpose of this paper is not to solve this problem analytically and neither to produce forecasts, the stationarity of the variables are not considered for the estimation procedure in the subsequent SS-model (Tanizaki, 1996). 

## 4,2 The Kalman Filter.

The Kalman filter developed by Kalman (1960) involves a two stage process where the unobserved variable can be estimated given the observable data and its error through the construction of a likelihood function (Pichler, 2007). Employing the above assumptions, that the system is linear and that errors follow a normal probability distribution, the process uses a recursive prediction and correction approach. For full derivations of steps, likelihood function and complete discussion see Kalman 1960. 

Assuming that possible values of the model parameters are known and equal to $(A^{*},B^{*},v^{*},w^{*})$ and can be summarized by $(A^{*},B^{*},v^{*},w^{*} = \Omega)$. Using Bayes theorem and letting the likelihood function associated with the model and given parameters be denoted as:

| $f(y_{1},y_{2}....y_{T};\Omega) = \prod_{t = 1}^{T} f(y|y^{t-1}; \Omega)$ \hfill{(eq I)}

| where $y^{t-1} = (y_{1}, y_{2}...y_{t-1})$ for all $t>=2$ \hfill{(eq 11)}

Gives the likelihood function that are to be maximized:

| $ln L (y^{T,\Omega}) = \prod_{t = 1}^{T} ln f(y|y^{t-1}; \Omega)$ \hfill{(eq III)}

The prediction stage begins with the derivation of the initial state $z_{0}|_{0}$ and an estimate of the related covariance matrix $\sum_{0 | 0}^{z} = E[(z_{0} - z_{0|0})(z_{0}-z_{0|0})]$. In this example it is assumed that this process is stationary, however this is not a requirement unless the filter operation is to solve a specific equation. Setting $t = 1$ giving:

| $(x_{t|t-1})$ and $\sum_{t|t_1}^x$ with the transition equation 
| $x_{t|t-1} = Cx_{t|t-1}$ and $\sum_{t-1|t-1}^x C´+ \sum_{w}$

It follows that $(x_{t|t-1})$ can then be used to construct a forecast of $y_{t|t-1} = Ax_{t|t-1}$ given that we can observe the dependent variable in the observation equation. It also allows for the forecast error to be constructed according to:

| $u_{t} = y_{t} - y_{t|t-1} = y_{t} - Ax_{t|t-1} = v_{t} + A(x_{t} - x_{t|t-1})$ \hfill{(eq IV)}

| Given that: $y_{t} = u_{t} + y_{t|t-1}$ leads to $f(y_{t}|y^{t-1};\Omega) = f(u_{t};\Omega)$

Based on previous states and error terms, current states and error terms have been produced by $(x_{t|t-1})$ and $\sum_{t|t-1}^x$ but in order to construct future state values we need the current values of $x_{t|t}$ and $\sum_{t}^x$.

Since we have observed the current value of $(y_{t})$ it is possible to correct the previous predictions of $(x_{t|t-1})$ and $\sum_{t|t-1}^x$ according to Kalman (1960) formula:

| $x_{t|t} = x_{t|t-1} + K_{t}(y_{t}-y_{t|t-1}) = x_{t|t-1} + K_{t}(y_{t} - Ax_{t|t-1})$ \hfill{(eq V)}

| $\sum_{t|t-1}^x = \sum_{t|t-1}^x - K_{t}(\sum^v + A\sum_{t|t-1}^xA´)K_{t}$ \hfill{(eq VI)}

| Where: $K_{t} = \sum_{t|t-1}^x A´(A\sum_{t|t-1}A´+\sum^v)^{-1}$ \hfill{(eq VII)}

Combining the previous prediction of the state and the current prediction of the error in $(y_t$) it is possible to construct a linear corrected prediction of the unobserved state variable. Furthermore, due to the linearity, the choice of $(K_{t})$ is to minimize the variance in the prediction error. 

This prediction and correction procedure is done recursively until $(t = T)$. When this point is reached the likelihood function can be constructed by the known model parameters according to:

| $ln (y^{T},\Omega)= \prod_{t = 1}^{T} f(y|y^{t-1}; \Omega)$ 

Producing smoothed and filtered states of the estimated model. The prediction filtered states gives the distribution of the current (post estimate) state given the observations up to and including the current time index. The smoothed states gives the distribution of past state/states, given the data up to the current time index, where the latter is to be employed in this paper.

## 4,3 Autoregressive Hidden Markov Switching model. 

In the field of economics, statistics and finance time series analysis is commonly plagued by the presence of structural breaks in the underlying data. This can generally cause problems with linear and non-linear estimators that may become unreliable given the non-stationarity (Hamilton, 2005). This usually represents events that dramatically change the behaviour of the data, e.g. new governmental policy or market condition that respond to a fundamental change in its environment, such as a financial crisis. However, these fundamental changes provide a point of inquiry for the underlying cause of these changes in regimes, that cannot be directly observed, but is present in the data. 

By employing the modelling developed by Hamilton (2005), consider the time series variable $(y_t)$ which can be modeled according to an autoregressive process described as:

| $y_{t} = aR_{t} + \lambda y_{t-1} + \epsilon_{t}$ With $\epsilon \sim N(0,\sigma^{2})$ for all $t>=1$ 

Where $(R_{t})$ denotes the state variable which behaves as a stochastic variable that is the result of an exogenous change. Should a simple replacement of the constant term $(a)$, then representing a significant change in the average of the time series, provide an improvement in the estimate of $(y_{t})$, it would be considered a deterministic change clearly visible and thus completely predictable (Hamilton, 2005). The state variable $(R_{t})$ captures these imperfectly predictable changes in the time series without assuming that they are deterministic and thus visible. The state variable is assumed to change over time and assume values of:

| $R_{t} = 1$ for $t = 1,2,,,,, t_{k}$ and $R_{t} = 2$ for $t = t_{0} + t1, t_{0} +t2,,,,,$

In order to describe the behaviour of $(R_{t})$ moving from one state/regime to another, a probabilistic model is required. A natural way of accomplishing this is to model the state of $(y_{t})$ as a markov chain of probabilities. Continuing with the simplicity of a two state markov chain:

| $Pr(R_{t} = j|R_{t - 1} = i, R_{t - 2} = k,,,y_{t-1},y_{t-2})$ \hfill{(eq VIII)}
| $= Pr(R_{t} = j|R_{t - 1} = i) = p_{ij}$ \hfill{(eq IX)}

Intuitively, this Markov chain of probabilities relies on past values and is autoregressive, with an emphasis on the values of the most recent state/regime. Meaning that several different regimes may exist and transition between said states occurs, such transitions are infrequent and considerable time may pass between transitions. The degree of permanence of the regime or state is represented by the value of $(pij)$. Which denotes the probability of transitioning from one state to another or remaining in the current state, represented as a probability matrix with its size equal to the number of states in the model. 

This constitutes an Autoregressive Hidden Markov Switching Model, which allows for the parameters to vary across regimes and can be viewed as an unrestricted model with initially “hidden” or unobservable regimes. The regimes evolve exogenously of the time series in question and the dimension primarily depends on theoretical considerations of the underlying data as well as calculation restrictions. Similarly to the dynamic linear system model in the previous section, the states cannot be observed directly/are “hidden”. However, the parameters of the model allow for inference of the probability of states within the model. 

## 4,4 Data collection and management.

The dependent column vector consists of the BOBUR, which is the three month interbank rate of Hungary issued by the central bank of Hungary (MNB, 2020). The interbank rate is issued monthly or minimum once per quarter depending on the need for adjustment decided by the Monetary Council (MNB, 2020). This data vector has been collected from the OECD database of main economic indicators reported in percentages, which are not seasonally adjusted. Harmonization of data points was achieved by taking the geometric mean for every quarter in absolute percentages points. This also ensures gaps in the data are eliminated, e.g. if a single rate is issued in a quarter it automatically becomes that quarters geometric average. 

The choice of the three month interbank rate rather than e.g. the one year government bond rate, is based on the direct impact on the banking system by central bank intervention and its relation to monetary policy. Other measurements such as the governmental bond rate present issues of rating of bonds, impact of pension funds and time of issuance for data collection. 

The independent column vector of inflation consists of consumer price index (CPI) adjusted for food and energy, i.e. core inflation for Hungary measured quarterly as the annual growth rate from the previous period in percentages. The base year for the inflation measurement is 2015, is not seasonally adjusted, based on a fixed set of consumer goods and services in fixed quantities and weighted according to a large number of elementary aggregate indices (OECD, 2020). This data vector has been collected from the OECD database of main economic indicators. As inflation has been highly unstable in former soviet occupied countries, the choice of using core inflation provides more stable data with less outliers.

Naturally, the column vector of target inflation is derived from the published reports of the MNB monetary Council, with the introduction of explicit inflation targeting with reference date December 2001 (MNB, 2020). Prior to this date managing price stability was the primary goal of the MNB, but not its sole goal. Aspiring entrance into the EMU was still pursued ex ante and ex post adoption of inflation targeting. As these two goals may not be fully compatible the MNB elected to let their currency float beginning in 2008 with inflation target adjustments being made every three to five years conditional on inflation forecasts and their realizations (MNB, 2020). 

The independent column vector of output consists of real Gross Domestic Product for Hungary measured in millions of Hungarian national currency (Forint), reports are issued quarterly and being seasonally adjusted. The data for this vector has been collected from the OECD database of main economic indicators (OECD, 2020). Other measures of deviations from potential output, such as unemployment deviation from the NAIRU are not considered in this paper. 

In addition, the Real Effective Exchange Rate (REER) is added to the open economy model. The REER adds an additional channel of transmission for monetary policy, as a potential intermediate target variable of MNB (Svensson, 2000). The REER consists of the real exchange rate of the Hungarian currency Forint against a basket of sixty economies weighted and indexed according to the size of trade with each basket country. The REER are derived as geometric weighted averages of bilateral exchange rates adjusted by consumer prices, reported monthly (BIS, 2020). Weights are derived from manufacturing trade flows with a time varying pattern, with weights being recalculated as recently as 2014-2016 (ibid), collected from the Bank of International Settlements (BIS). 

As with harmonizing the BOBUR, the monthly data points are converted to a geometric mean for all quarters in absolute percentage points. The choice of measurement being the weighted and indexed REER, is guided by the desire to capture changes in the real exchange rate in consideration of the major trading partners of Hungary. Rather than simply taking into account the largest one, the Euro area, thus capturing a wider relationship to Hungarian monetary policy. 

Both models require the same basic variable construction and are estimated in R using the MSWM (Markov Switching model) and KFAS (Dynamic Linear System Model) packages respectively.

Constructing the definition of the inflation gap was accomplished by subtracting the inflation target from the actual measure of core inflation. Data points in the inflation target vector prior to the introduction of inflation targeting was set to zero, making the inflation gap equal the core inflation (Kuzin, 2004). The output gap is defined by decomposing the real GDP using the Hodrick Prescott filter, to extract the trend and cyclical components respectively with the customary penalizing agent of $\lambda = 1600$ for quarterly data (Hodrick and Prescott, 1997). The resulting trend component was then used as the denominator when taking the quotient of the natural log of real GDP and natural log of the trend component, multiplied by 100 for scaling. This procedure was repeated for the Forint REER indices, producing a REER gap of the actual indices for the basket of economies and the trend level of REER for said basket. 

## 4,5 Autoregressive Hidden Markov Model.

The HMM estimation procedure, described above, requires that a gaussian linear model is estimated with the associated characteristics of OLS. After which the expectation-maximization (or EM) algorithm is applied to the defined gaussian linear model through the MSWM package. 

One additional regressor is included in the form of a lagged dependent variable, this is due to strong autocorrelation of the residuals in the error term $(t)$. This effect is referred to as interest rate smoothing (Clarida, Gali, Gertler, 1998), capturing the tendency of central banks maintain momentum in changes of the nominal interest rate. The coefficient of the lagged interest rate determines the degree of interest rate smoothing, with the term $\rho = \sum_{j=1}^\rho = \rho_{j}$ represents a persistence measure. Unit root and Stationarity tests for all gap variables were conducted according to the Augmented Dickey Fuller (ADF) and Kwiatkowski–Phillips–Schmidt–Shin (KPSS) tests. The ADF unit root test indicates a positive unit root in BOBUR only (see Appendix). The KPSS test indicates that all variables are trend stationary with non-rejected nulls for all variables. Breakage-tests with unknown breakage points were conducted on all variables where the inflation gap exhibited two breaks in 2002 and 2010, and the BOBUR exhibited breaks in 2004, 2009,  2012 and 2017. 

Determining the AR(p) component of the HMM employed both Akaike Information Criterion (AIC) and Bayesian Information Criterion (BIC) were calculated for up to ten lags of each independent variable. Results of these tests were inconclusive and not pursued. Furthermore, a Partial Autocorrelation Function (PACF) was employed to determine the number of lags of each dependent variable with a maximum of five lags. The results for both the inflation and output gap variable suggest a lag length of one, The REER gap shows signs of seasonality with lag indications every three lags, consistent with a seasonal pattern of one per year. Extended PCAF tests with a maximum of thirty lags rejected the hypothesis of a seasonal component in REER. The REER gap was estimated with a zero lag length. Furthermore, the intercept does not produce any meaningful result as it is likely not a constant and conditional on fluctuations in the Wicksellian rate of interest (Woodford, 2001).

The number of regimes estimated is empirically indicated to be three; one per independent variable, excluding the lagged nominal rate. In the estimation process a three state regime was rejected on the basis that the model estimation matrix approaches singularity. Instead a two regime autoregressive model with time varying coefficients was estimated according to:

| $(i_{t} - i_{t-1}) = \beta_{1}(\pi_{t} - \pi_{t}^{*}) + \beta_{2}(y_{t} - y_{t}^{*}) + \beta_{3}(\rho_{t} - \rho_{t}{*})(1-\rho) + i_{t-1} + \epsilon_{t}$ \hfill{(eq X)}

Where: $i_{t} =$ BOBUR at time $t$, $(\pi_{t}-\pi_{t}^{*}) =$ inflation gap at time $t$, $(y_{t} - y_{t}^{*}) =$ output gap at time $t$, $(\rho_{t}-\rho_{t}^{*}) =$ REER gap at time $t$, $i_{t-1} =$ interest rate smoothing, $\epsilon_{t} =$ error term at time $t$.

## 4,6 State-Space Model.

The state space model estimated differs from the HMM in that the autoregressive element of interest rate smoothing was omitted on the basis that it did not add anything qualitatively to the results. Such a model was estimated in line with the autocorrelation argument but did not affect the coefficients in any meaningful manner, only increasing the parametrization of the model. Disturbance matrices were specified with each state having an initial inherent disturbance (off-diagonal elements equal to zero) and covariances. Allowing the smoothing algorithm to estimate appropriate initial values for all state vectors, where all independent state vectors were assumed to follow a random walk without a drift. The variation in the model is exclusive to the level of the weights and not the variables in their entirety. Again the intercept is excluded in order to keep the model identifiable and not add an additional disturbance term (Helske, 2016). The estimated model is thus: 

| $i_{t} = \beta_{1}(\pi_{t} - \pi_{t}^{*}) + \beta_{2}(y_{t}-y{t}^{*}) + \beta_{3}(\rho_{t} - \rho_{t}^{*}) + \epsilon_{t}$ \hfill{(eq XI)}

\newpage{}

# 5 Empirical Results & Discussion
## 5,1 Empirical Results

With Kalman filter results, traditional numeric output tables would serve no purpose in the context of mediating any results produced by the Kalman filter. As coefficients vary across time a graphical representation is a more appropriate setting for demonstrating the estimates of the modified Taylor rule. Each smooth estimate can be described as the expectation conditional on the nominal rate and other structural parameters, or more formally $E[\beta_{t}|i_{t},\Omega]$. The smooth estimates of variables displayed as continuous lines with 95% confidence intervals calculated as standard $\beta\pm2$RMSE of each individual smoothed state estimate.
```{r, fig.align="center", fig.height=3, fig.width=6, fig.cap="Inflation gap estimate including confidence intervals", echo=FALSE, message=FALSE, warning=FALSE}
#Smooth state inflation gap
plot(state_CIs1[,1], type = "line", xaxt = "n", 
     xlab = NA, ylab = "Betas Inflation gap", ylim = c(-5, 6))
lines(state_CIs1$up_x1, lty = 'dashed', col = 'blue')
lines(state_CIs1$low_x1, lty = 'dashed', col = 'blue')
abline(h = 0, col = "black")
axis(1, las = 2, at = c(0,10,20,30,40,50,60,70,80),labels = c("2000-Q1","2002-Q2","2004-Q4","2007-Q2",
"2009-Q4","2012-Q2","2014-Q4","2017-Q2","2019-Q4"))
```
Comparing the nominal rate and the estimate of the inflation gap in Figure 1 indicates movements consistent with a central bank responding to deviations from the target inflation during the first half of the sample, with a strong emphasis on positive deviations. Significant negative inflation gap coefficients are rare but occur at three peaks in 2005, between 2010-2011 and in 2014. Excluding 2010-2011, they fairly immediately return to non negative weights. The majority of the time period exhibits fairly large weights on the inflation gap as prescribed by the Taylor rule. Ranging from consistent weights in the vicinity of 1-2, well above unity, and in some circumstances up to weights between 3-4. This is particularly noticeable during the peaks of 2004 and 2009, indicating a active conservative central bank prioritizing anti inflationary tendencies which are consistent with the lagged monetary policy enacted with inflation targeting. The end half of the sample exhibits more instability in the commitment to positive weights for the inflation gap, as the monetary policy regime allows for more persistent negative weights during 2008-2017, indicating a more passive Taylor rule. 
```{r, fig.align="center", fig.height=3, fig.width=6, fig.cap="Output gap estimate including confidence intervals", echo=FALSE, message=FALSE, warning=FALSE}
#Smooth state output gap
plot(state_CIs2[,1], type = "line", xaxt = "n", 
     xlab = NA, ylab = "Betas Output gap", ylim = c(-5, 5))
lines(state_CIs2$up_x2, lty = 'dashed', col = 'blue')
lines(state_CIs2$low_x2, lty = 'dashed', col = 'blue')
abline(h = 0, col = "black")
axis(1, las = 2, at = c(0,10,20,30,40,50,60,70,80),labels = c("2000-Q1","2002-Q2","2004-Q4","2007-Q2",
"2009-Q4","2012-Q2","2014-Q4","2017-Q2","2019-Q4"))

```
The coefficients of the output gap in Figure 2 displays similar irregularities as the inflation gap at certain intervals. Initial fairly large positive weights on the output gap indicates emphasis on economic growth and an active monetary policy regime, particularly during the mid 2000s. A consistent negative weight is observed during the financial crises in the vicinity of 2008, recovery to expected positive weights of 1-2 is slow. Comparing weights of the inflation and output gasp, the latter tracks as reversed, e.g. in 2005. Suggesting that monetary policy prioritizing the weight of the inflation gap subtract from the weight put on the output gap in a procyclical manner, similar to Tarkhan-Mouravi (2009). Although, this effect appears to be alternating as this is not consistent, e.g. weights in 2004 are tremendously positive for both gaps respectively. Similar to the inflation gap, the first half of the sample pre-2008 indicates activist monetary policy, with passivity after 2008. 
```{r, fig.align="center", fig.height=3, fig.width=6, fig.cap="REER gap including confidence intervals", echo=FALSE, message=FALSE, warning=FALSE}
#Smooth state REER gap

plot(state_CIs3[,1], type = "line", xaxt = "n", 
     xlab = NA, ylab = "Betas REER gap", ylim = c(-5, 6))
lines(state_CIs3$up_x3, lty = 'dashed', col = 'blue')
lines(state_CIs3$low_x3, lty = 'dashed', col = 'blue')
abline(h = 0, col = "black")
axis(1, las = 2, at = c(0,10,20,30,40,50,60,70,80),labels = c("2000-Q1","2002-Q2","2004-Q4","2007-Q2",
"2009-Q4","2012-Q2","2014-Q4","2017-Q2","2019-Q4"))
```
Compared to both output and inflation gaps, the REER gap estimates in Figure 3 exhibits far more volatility. Tremendous, mostly positive peaks occur during the early to mid 2000s. Corresponding to significant economic growth and emphasis on the output gap by active the monetary policy regime. Comparing the nominal rate to the estimated smooth coefficient of the REER gap, it responds relatively heavily until approximately 2006. At which point both positive and negative movements stabilize within a band of weights -2 to 2. Response to the financial crises in the vicinity of 2008 is slightly unstable, yet continuously negative until 2012. Similar to the inflation gap, the REER gap does not seem to be a priority during the period of the financial crises.  

Residuals of all states were independently tested using the Jarque-Bera test. Where the null of residual normality could not be rejected for inflation and output gaps respectively, although the null of residual normality was rejected for the REER gap (see Appendix).

In the HMM estimation two different regimes were identified by the HMM framework, describing an active monetary policy regime and a passive monetary policy regime. 
```{r, fig.align="center", fig.height=5, fig.width=6, fig.cap="Filtered and Smoothed Probabilities of regimes", echo=FALSE, message=FALSE, warning=FALSE}
#plotting smoothed and filtered probabilities
plotProb(model_HMM1, which = 1)
axis(1, las = 2, at = c(0,10,20,30,40,50,60,70,80),labels = c("2000-Q1","2002-Q2","2004-Q4","2007-Q2",
"2009-Q4","2012-Q2","2014-Q4","2017-Q2","2019-Q4"))

summary(model_HMM1)
```
Figure 4 displays the smooth and filtered probabilities of each identified regime. Both regimes retain fair persistence, with small probability of transitioning between them and high probability of remaining in one regime once transition has occurred.

Regime number one was dominant during 2000-2004 primarily, between 2008-2010 and during 2012. It was characterized by emphasis on both the output and REER gaps by monetary policy. Both parameters respectively are significant, with weights being fairly small in size (well below $0.5$). The sign for the REER gap is negative, indicating that monetary policy will adjust to rises in the REER gap but not considering it a priority given its small weight. This is consistent with results from the SS model smooth estimates of the output gap and REER gap. Note also that the inflation gap is not significant during this regime's duration.

Regime number two was dominant during 2004-2008 and between 2012-2020 and was characterized by much smaller estimates of the output gap, with no emphasis on the REER or inflation gap. The output gap variable is still significant in this regime but close to zero, consistent with the SS model and a passive monetary policy regime.

## 5,2 Empirical Discussion.

The MNB displays fairly strong central bank conservatism throughout the first half of the sample period, with significant weight put on managing the inflation gap with short term periods with negative inflation gap coefficients. Particularly, rapid disinflation with active monetary policy occurs during the first regime, which is absent during the second regime characterized by stable core inflation with passive monetary policy. Occasional negative coefficients of the inflation gap are unusual although observed in linear estimates previously (Kuzin, 2006). These negative estimates are rare and may indicate procyclical behaviour of the central bank. Considering historical Hungarian levels of core inflation, it is unsurprising to find less weight on negative deviation of the inflation gap. There is also partial evidence of inflationary bias (Svensson 2003), as the average inflation (3,9%) is slightly elevated compared to the announced inflation target for the majority of the sample (3-7%).

Similar distinctions can be observed in the weights of the output gap, where the first half of the sample period remains in significant positive figures. Even with credible inflation targeting stabilizing economic growth will help stabilize future inflation (Svensson, 2003). The weights prescribed by Taylor are on average smaller than what is observed for both the inflation and output gaps, indicating that both gaps may be periodically more significant than expected for monetary policy in Hungary during the first half of the sample period. 

Results from the HMM supports the SS-model in that the output gap is a significant factor in determining the nominal rate, as the output gap is significant in both regimes identified. In contrast, one surprising result is the inflation gap not being identified as important in either regime. However, observing the relationship between the inflation and REER gaps in more detail, it becomes less ambiguous. The REER gap can be perceived as an intermediate goal of stabilizing inflation, in support of Svenssons (2000) formulation of strict-inflation targeting. 

Hungary's commitment to join the EMU, entailing a de-facto fixed exchange rate, was still in effect during the first half of the sample period (ending in 2008). By maintaining the bandwidth fixed exchange rate, it was technically importing inflation levels from the EMU area, which was lower than the domestic Hungarian inflation. This makes the REER gap an intermediate instrument target for lower and stable inflation, whilst maintaining its commitment to join the currency area (Svensson, 2000). The REER gap coefficient in the HMM regime number one is consistent with a fixed exchange rate regime which prioritizes the intermediate goal of the REER above inflation as suggested by Frömmel and Schobert (2006). Approximately halfway through the sample period this policy is changed, the Forint is allowed to float which corresponds to much smaller coefficients for the REER gap in the SS-model and a new regime in the HMM. 

In addition to the role of intermediate goal for inflation oriented monetary policy, some important aspects of the REER gap results pertain to the effect of transitioning from a fixed/semi fixed exchange rate to a floating exchange rate. With a fixed exchange rate, it is exposed to currency speculation. The coefficient for the REER gap in the SS-model reflects this shifting in weights during the first half of the sample period, where the central bank is forced to respond to changes in REER relative to Hungary's largest trading partners. The lack of a long term highly liquid security market in Hungary, would also produce a more volatile REER gap with swift and sizable changes in line with Tarkhan-Mouravi (2009). 

This added volatility is addressed by the monetary policy regime which shifts the weights to be both volatile and reach greater values than would be expected with a floating exchange rate. When this exchange rate policy is reevaluated in 2008, it is also reflected in the coefficients which become smaller and consistently negative as inflation targeting becomes more important. Structural changes in the economy may also have contributed to this transition from an activist monetary policy to a more passive one. It also coincides with the financial crises, straining economies globally. The inflation gap parameter with a consistent heavy weight attached and the REER gap with an initially heavy weight, is demonstrated more clearly in the SS-model compared to the HMM. Another important aspect the SS-model captures is the consistent behaviour of all gap parameters at the end of 2014 through the end of the sample in 2020.

All coefficients in the SS model remain close to zero from the end of 2014 to 2020, which seem quite vexing. Two OLS regressions were conducted with separated observations prior to and and after 2014 in order to determine if any model parameter becomes insignificant after the end of 2014. The results show that all parameters are indeed significant ex post 2014 (see Appendix), rejecting the notion that the model breaks down after 2014. This is corroborated by close inspection of the nominal rate (see Appendix), as the nominal rate degrades from two percent towards zero from 2014 onward. 

Monetary policy would seem to become ineffective as inflation, output and REER gaps become less responsive to nominal rate movements. In essence, after 2014 weights of the gap variables no longer empirically represent any significant part of the monetary policy. Not due to the MNB no longer considering them when conducting monetary policy, but due to the fact that any monetary policy issued does not retain any effect on the gaps. This could represent a new regime in itself where traditional monetary policy no longer provides means of control over macroeconomic parameters. The modified Taylor rule in this context breaks down when the effectiveness of the nominal rate fails. However, it is important to note the fact that core inflation remains stable with the new passive monetary policy regime (see Appendix), which fulfills the policy objective.

From an empirical point of view, the change from one regime to another seem credible. However, this may not be the representative of the domestic markets perspective. The central bank could have altered its policy but the microfoundations in the economy might remain with expectations of the past regime. This could also affect and be affected by the banking system, which should be facilitating the transition between interbank interest rates to firms and consumers. As the nominal rate approaches zero the domestic market rates and exchange rates should adapt accordingly, this is indeed visible, but distorted due to the outside lag. 

Elements from the Lucas critique of the Taylor rule in this context seems to apply when the effectiveness of monetary policy breaks down. Underlying factors such as a shift in policy regime in 2008 do not necessarily alter the expectations of agents subject to that regime. If agents are static in their expectations, as they cannot forecast accurately and perceive that inflation is relatively stable with a low nominal rate they will act in accordance with those expectations. These agents would then anticipate changes in the nominal rate according to a different regime than is actually implementing policy. Consistent with central banks in other economies with ineffective monetary policy, the MNB signaled that it will cautiously employ unconventional monetary policy instruments, such as long term interest rate swaps with ten years maturity and limited quantitative easing (MNB, 2020). These unconventional policies seem to have produced a mixed result, as the inflation gap is within one percent of the target between 2012 - 2020.

For quantitative easing to be effective commercial banks need to translate the increased liquidity into loans for firms and consumers. In Hungary this link has proved to be somewhat defective, as commercial banks replenish their own D/E ratios to attract further investments and provide the impression of positive performance (OECD, 2020). The net effect of unconventional monetary policy becomes insignificant as no real liquidity reaches the economy. This is reminiscent of a liquidity trap, which would put the economy in a deadlock until interest rates rise or government spending increases. The latter alternative is unlikely as the Hungarian government spending is already high compared to its eastern European counterparts and has recently begun to decline (OECD, 2020). 

Theory would suggest that a flexible exchange rate would alleviate restrictions on capital mobility, which appears to be true for the second half of the sample period after 2008. However, when monetary policy becomes ineffective, the situation becomes comparable to allowing a fixed exchange rate. Macroeconomic variables such as inflation and output can no longer be adequately controlled, with one important difference; under a fixed exchange rate there is the last resort option of devaluation. Which could act as a pressure release although sacrificing central bank credibility in the process. 

Moreover, the interim period between 2008 and 2014 shows some additional preference for the inflation gap over the output gap, prioritizing price stability above drop in output due to shocks, in line with the AS-AD framework. As this coincides with the financial crises and its immediate aftermath, the results would imply that when a significant shock does hit the Hungarian economy the central bank puts additional weight on the inflation gap rather than to preserve high output. This adds some credibility to the monetary policy conducted by the central bank, in accordance with minimizing its loss function and maintaining price stability. 

Comparably, the smooth estimates of the inflation gap are smaller than that of Kuzins (2004). However, Kuzins study emphasizes the time-varying property of the inflation gap, leaving other parameters as time-invariant. This precludes a true comparison of the inflation gap with other parameters such as output or additions to the Taylor rule. 

Additionally, Cukierman (2008) and Judd, Rudebusch (1998) in partial agreement with Kuzin suggests that differences in preferences by different policy makers in the central bank can produce non-linear reaction functions. Where alternating between inflation avoidance (IAP) or recession avoidance (RAP) can produce either convex or concave reactions functions, depending on the size of weights attributed to either gap (Cukierman, 2008). This is partially consistent with the rare negative weights found in both output and inflation gaps coefficients.

\newpage{}

# 6 Concluding Remarks.

This paper demonstrates that two different monetary policy regimes can be empirically detected in Hungary during the period of 2000Q1 to 2020Q2, using the extended State-Space framework that descriptively captures both regimes and their transitory nature over time. These monetary policy regimes entail some growth targeting and inflation targeting through an intermediate target of the Hungarian REER with an initially active policy regime shifting to a passive one. Non-conclusive evidence is found for procyclicality between inflation and output as regimes transition during the sample period. The second half of the sample strongly suggests the monetary policy regime becomes passive due to structural changes and that the monetary policy instrument become ineffective in managing the gap parameters. With stable core inflation within stated target range in agreement with MNBs price stability objective.

The results of this paper are in agreement with previous studies of Hungarian monetary policy, such as Tarkhan (2009). With rare negative coefficients for both inflation and output gaps observed in the Hungarian case, including limited evidence of exchange rate targeting. Both studies indicate a limited or no expectation effect (rational behaviour) in Hungary; as with many emerging countries with underdeveloped highly liquid security markets, the response appears to be heavy and immediate when shocks hit the economy which is evident in both studies. Moreover, the apparent ineffectiveness of monetary policy found in other economies can be attributed to Hungary post 2008-2014, other larger economies such as the US are subjected to similar predicaments (Judd, Rudebusch 1998). This paper illuminates the increased importance of unconventional monetary policy and fiscal policies in regulating the traditional parameters of the Taylor rule and the potential dangers of liquidity traps. 

Limitations of this study pertain to the constrained measurements of the dependent variable, as critiqued by Taylor (1999) who suggests using monetary aggregates rather than the nominal interest rate itself. Similar limitations can be construed by Woodford (2001) in measurement of the output gap, yielding potentially different results if a cost-price ratio is applied. This study presents no evidence of optimal monetary policy for Hungary or the Visegrad four, but rather a descriptive representation of past information and behaviour of monetary policy regimes. 

Potential for further research could entail more detailed and/or sophisticated measurements of instruments or intermediate targets/variables, additional dummy variables for liquidity requirements or revised central bank loss functions resulting in non-linear Taylor rules for time-varying estimations. The impact of unconventional monetary policies such as quantitative easing when conventional monetary policy becomes effective, could provide additional fields of research particularly when conducted in comparison with monetary policy rules. 

\newpage{}

# 7 References

Benhabib, Jess; Schmitt-Grohe, Stephanie; Uribe, Martin (1998) : The perils of Taylor Rules, Working Paper, No. 1998-31, Rutgers University, Department of Economics, New Brunswick, NJ, pp.1-17. 

Balabay, O., 2011. Is The Taylor Rule A Good Approximation Of The Norwegian Monetary Policy?. Master of arts. Uppsala Universitet, Department of Economics, pp.5-38.

Clarida, Richard, Jordi Gali, and Mark Gertler. 1998. “Monetary Policy Rules in Practice: Some International Evidence.” European Economic Review 42 (6): pp.1033-67. 		

Christiano, L. and Rostagno, M., 2001. Money growth monitoring and the Taylor rule. National Bureau of economic research, [online] (1), pp.1-54. Available at: <https://www.researchgate.net/publication/5196511_Money_Growth_Monitoring_and_the_Taylor_Rule> [Accessed 20 October 2020].

Cukierman, Alex & Muscatelli, Anton. (2008). Nonlinear Taylor Rules and Asymmetric Preferences in Central Banking: Evidence from the United Kingdom and the United States. Contributions to Macroeconomics. 8. 1488-1488. 10.2202/1935-1690.1488, pp.1-26.

Durbin, J. and Koopman, S., 2014. Time Series Analysis By State Space Methods. 2nd ed. Oxford: Oxford University Press, pp.4-23.

Eurostat, Gross Domestic Product for Hungary [CPMNACSCAB1GQHU], retrieved from FRED, Federal Reserve Bank of St. Louis; https://fred.stlouisfed.org/series/CPMNACSCAB1GQHU, [Accessed December 4 2020].

Encyclopedia Britannica. 2020. Hungary - World War I. [online] Available at: <https://www.britannica.com/place/Hungary/World-War-I> [Accessed 7 December 2020].

Frömmel, M. and Schobert, F., 2006. Monetary Policy Rules in Central and Eastern Europe. Department of Economics, Leibniz Universität Hannover, [online] 1(1), pp.1-13. Available at: <https://ideas.repec.org/p/han/dpaper/dp-341.html> [Accessed 16 October 2020].	

Gerlach-Kristen, Petra, 2003, Interest rate reaction functions and the Taylor rule in the euro area, ECB Working Paper, No. 258, European Central Bank (ECB), Frankfurt a. M, pp.9-31.

Hodrick, R. and Prescott, E., 1997. Postwar U.S. Business Cycles: An Empirical Investigation. Journal of Money, Credit and Banking, 29(1), pp.1-12.

Hamilton, James. (2008). Regime-Switching Models. 10.1057/9780230280830_23. pp.1-10.

Helske, Jouni. (2016). KFAS: Exponential Family State Space Models in R, pp.1-38.

Ibrahim Arısoy, 2013. TESTING FOR THE FISHER HYPOTHESIS UNDER REGIME SHIFTS IN TURKEY: NEW EVIDENCE FROM TIME-VARYING PARAMETERS. International journal of economics and financial issues, 3(2), pp.496–502.

Judd, John & Rudebusch, Glenn. (1998). Taylor's Rule and the Fed: 1970-1997. Economic Review. 3. pp.3-16. 

Kuzin, V., 2006. The inflation aversion of the Bundesbank: A state space approach. Journal of Economic Dynamics and Control, 30(9-10), pp.1671-1686.

Kalman, R. E. (1960): “A New Approach to Linear Filtering and Predic- tion Problems,” Transactions of the ASME–Journal of Basic Engineering, 82(Series D), pp.35–45.

Lucas, R., 1976. Econometric policy evaluation: A critique. Carnegie-Rochester Conference Series on Public Policy, [online] (1), pp.19-46. Available at: <http://people.sabanciuniv.edu/atilgan/FE500_Fall2013/2Nov2013_CevdetAkcay/LucasCritique_1976.pdf> [Accessed 18 November 2020].	

Mnb.hu. 2020. Exchange Rate Regime. [online] Available at: <https://www.mnb.hu/en/monetary-policy/monetary-policy-framework/exchange-rate-regime> [Accessed 5 December 2020].

Mnb.hu. 2020. Inflation Targeting. [online] Available at: <https://www.mnb.hu/en/monetary-policy/monetary-policy-framework/inflation-targeting> [Accessed 5 December 2020].

Mnb.hu. 2020. The Monetary Council. [online] Available at: <https://www3.mnb.hu/en/monetary-policy/the-monetary-council> [Accessed 5 December 2020].

Mnb.hu. 2020. MNB Introduces A New Ten-Year Interest Rate Swap Facility To Encourage Banks’ Purchases Of Government Securities. [online] Available at: <https://www.mnb.hu/en/pressroom/press-releases/press-releases-2015/mnb-introduces-a-new-ten-year-interest-rate-swap-facility-to-encourage-banks-purchases-of-government-securities> [Accessed 5 December 2020].

Mnb.hu. 2020. Institutional Framework for Inflation Targeting. [online] Available at: <https://www.mnb.hu/en/monetary-policy/monetary-policy-framework/inflation-targeting> [Accessed December 6 2020]

Nelson, Edward. (2001). UK Monetary Policy 1972-97: A Guide Using Taylor Rules. Central Banking, Monetary Theory and Practice: Essays in Honour of Charles Goodhart. 1. 10.4337/9781781950777.00020, pp.1-14.

Orphanides, Athanasios, 2002. Activist stabilization policy and inflation: The Taylor rule in the 1970s, CFS Working Paper, No. 2002/15, Goethe University Frankfurt, Center for Financial Studies (CFS), Frankfurt a. M., http://nbn-resolving.de/urn:nbn:de:hebis:30-10050.

Orphanides, A., 2003. Historical monetary policy analysis and the Taylor rule. Journal of Monetary Economics, 50(5), pp.983-1022.		

OECD (2020), General government spending (indicator). doi: 10.1787/a31cbf4d-en [Accessed 05 December 2020].

OECD (2020), Financial corporations debt to equity ratio (indicator). doi: 10.1787/a3108a99-en, [Accessed 05 December 2020].

Organization for Economic Co-operation and Development, 3-Month or 90-day Rates and Yields: Interbank Rates for Hungary [IR3TIB01HUM156N], retrieved from FRED, Federal Reserve Bank of St. Louis; https://fred.stlouisfed.org/series/IR3TIB01HUM156N, [Accessed December 6 2020].

Organization for Economic Co-operation and Development, (2020), Inflation (CPI) (indicator). doi: 10.1787/eee82e6e-en [Accessed 07 December 2020].

Pichler, P., 2007. 40461 Vektorautoregressive Methoden, pp.1-7.

Reschreiter, A., 2010. The effects of the monetary policy regime shift to inflation targeting on the real interest rate in the United Kingdom. Economic Modelling, 28(1-2), pp.754-759.

Svensson, Lars. (2000). Open–Economy Inflation Targeting. Journal of International Economics. 50. 10.1016/S0022-1996(98)00078-6, pp.1-29.

Svensson, L., 2003. What Is Wrong with Taylor Rules? Using Judgment in Monetary Policy through Targeting Rules. Journal of Economic Literature, 41(2), pp.426-477.

Stats.bis.org. 2020. [online] Available at: <https://stats.bis.org/#df=BIS:BISWEB_EERDATAFLOW(1.0);dq=.R..HU%3FlastNObservations=6;pv=~4~0,0,0~name> [Accessed 7 December 2020].

Taylor, John B. 1993. “Discretion versus Policy Rules in Practice.” Carnegie-Rochester Conference Series on Public Policy, 39: pp.195-214. 

Taylor, John B. Monetary Policy Rules. Vol. 31, University of Chicago Press, 1999. pp.1-15, 92.

Tarkhan-Mouravi, G., 2009. ESTIMATING TAYLOR-TYPE RULES IN CENTRAL AND EASTERN EUROPE. Master of Arts. Central European University, Department of Economics, pp.1-31.

Tanizaki, H., 1996. Nonlinear Filters. 1st ed. Berlin: Springer, pp.1-14.

Takeshi Hoshikawa (2012) Regime shift of Japanese foreign exchange policy:
some findings, Applied Economics Letters, 19:1, 25-28, DOI: 10.1080/13504851.2011.566003

Woodford, M., 2001. The Taylor Rule and Optimal Monetary Policy. American Economic Review, 91(2), pp.232-237.	

Österholm, Pär. (2005). The Taylor Rule: A Spurious Regression. Bulletin of Economic Research. 57. pp.217-247. 

\newpage{}
# Appendix
```{r, results='hide', message=FALSE, warning=FALSE}

#Data management

PKGs = c("tidyverse","dplyr","readxl","ggplot2","dbplyr","zoo","lubridate","broom","tseries",
         "quantmod","tframePlus","magrittr","tidyr","ggfortify","mFilter","KFAS","xts","aTSA",
         "dynlm","tinytex","latexpdf","MSwM","strucchange","methods","stats","knitr",
         "rmarkdown","utf8", "knitr", "kableExtra")

lapply(PKGs, library, character.only = TRUE, quietly = TRUE)

#Importing and checking data set

Data1 = read.csv(url(
  "https://raw.githubusercontent.com/Daniel-Svanholm/main/Main/data1.csv"))
```

```{r, results='hide', message=FALSE, warning=FALSE}
#Creating inflation and output gap variables
Data2 = mutate(Data1, inf_gap = (core_inf - inf_target))

HP = hpfilter(Data2[,5], freq=1600)

Data3 = cbind(Data2, HP$trend)

Data3 = mutate(Data3, output_gap = 100*log(gdp_real / HP$trend))

Data3 = subset(Data3, select = 
                 -c(HP$trend, gdp_delta, gdp_real, inf_target, core_inf))
Data4 = subset(Data3, select = 
                 c(date, IR3T_geomean, inf_gap, output_gap, HUF_60_geomean))

#Creating REER gap
HP1 = hpfilter(Data4[,5], freq=1600)

Data5 = cbind(Data4, HP1$trend)

Data5 = mutate(Data5, REER_gap = 100*log(HUF_60_geomean / HP1$trend))

Data5 = subset(Data5, select = -c(HP1$trend))
Data5 = subset(Data5, select = 
                 c(date, IR3T_geomean, inf_gap, output_gap, REER_gap))

```

```{r, results='hide', message=FALSE, warning=FALSE}
#Unit root tests for all variables
adf.test(Data5$IR3T_geomean)
#Non stationary

adf.test(Data5$inf_gap)
#Stationary

adf.test(Data5$output_gap)
#Stationary

adf.test(Data5$REER_gap)
#Stationary

#Trend Stationarity tests for all variables

kpss.test(Data5$IR3T_geomean)
#Trend Stationary

kpss.test(Data5$inf_gap)
#Trend Stationary

kpss.test(Data5$output_gap)
#Trend Stationary

kpss.test(Data5$REER_gap)
#Trend Stationary

#Structural break diagnostics
IR3T_ts = as.ts(Data5[,2])
inf_gap_ts = as.ts(Data5[,3])
output_gap_ts = as.ts(Data5[,4])
REER_gap_ts = as.ts(Data5[,5])


#IR3T break tests
breakpoints_IR3T = breakpoints(IR3T_ts ~ 1)

CIs_IR3T = confint(breakpoints_IR3T)

#Plot breakpoints with intervals
plot(IR3T_ts)
lines(breakpoints_IR3T)
lines(CIs_IR3T)
axis(1, las = 2, at = c(0,10,20,30,40,50,60,70,80),labels = c("2000-Q1","2002-Q2","2004-Q4","2007-Q2",
"2009-Q4","2012-Q2","2014-Q4","2017-Q2","2019-Q4"))
#Four breaks detected 2004, 2009, 2012, 2017


#Inflation gap break test
breakpoints_inf = breakpoints(inf_gap_ts ~ 1)

CIs_inf = confint(breakpoints_inf)

#Plot breakpoints with intervals
plot(inf_gap_ts, xaxt = "n", xlab = NA)
lines(breakpoints_inf)
lines(CIs_inf)
axis(1, las = 2, at = c(0,10,20,30,40,50,60,70,80),labels = c("2000-Q1","2002-Q2","2004-Q4","2007-Q2",
"2009-Q4","2012-Q2","2014-Q4","2017-Q2","2019-Q4"))
#Two breaks: 2002 and 2010


#Output gap break test
breakpoints_output = breakpoints(output_gap_ts ~ 1)

#Plot breakpoints with intervals
plot(output_gap_ts, xaxt = "n", xlab = NA)
lines(breakpoints_output)
axis(1, las = 2, at = c(0,10,20,30,40,50,60,70,80),labels = c("2000-Q1","2002-Q2","2004-Q4","2007-Q2",
"2009-Q4","2012-Q2","2014-Q4","2017-Q2","2019-Q4"))
##No breaks detected


#REER gap break test
breakpoints_REER = breakpoints(REER_gap_ts ~ 1)

#Plot breakpoints with intervals
plot(REER_gap_ts)
lines(breakpoints_REER)
axis(1, las = 2, at = c(0,10,20,30,40,50,60,70,80),labels = c("2000-Q1","2002-Q2","2004-Q4","2007-Q2",
"2009-Q4","2012-Q2","2014-Q4","2017-Q2","2019-Q4"))
#No breaks detected
```

```{r}
#Plots of all coefficients

plot(Data1$core_inf, type = "line", xaxt = "n", 
     xlab = NA, ylab = "Core inflation")
abline(h = 0, col = "black")
axis(1, las = 2, at = c(0,10,20,30,40,50,60,70,80),labels = c("2000-Q1","2002-Q2","2004-Q4","2007-Q2",
                                                              "2009-Q4","2012-Q2","2014-Q4","2017-Q2","2019-Q4"))
```

```{r}
plot(Data5$IR3T_geomean, type = "line", xaxt = "n", 
     xlab = NA, ylab = "Nominal rate") 
abline(h = 0, col = "black")
axis(1, las = 2, at = c(0,10,20,30,40,50,60,70,80),labels = c("2000-Q1","2002-Q2","2004-Q4","2007-Q2",
"2009-Q4","2012-Q2","2014-Q4","2017-Q2","2019-Q4"))
```

```{r}
plot(Data5$inf_gap, type = "line", xaxt = "n", 
     xlab = NA, ylab = "Inflation gap")
abline(h = 0, col = "black")
axis(1, las = 2, at = c(0,10,20,30,40,50,60,70,80),labels = c("2000-Q1","2002-Q2","2004-Q4","2007-Q2",
"2009-Q4","2012-Q2","2014-Q4","2017-Q2","2019-Q4"))
```

```{r}
plot(Data5$output_gap, type = "line", xaxt = "n", 
     xlab = NA, ylab = "Output gap", ylim = c(-14, 5))
abline(h = 0, col = "black")
axis(1, las = 2, at = c(0,10,20,30,40,50,60,70,80),labels = c("2000-Q1","2002-Q2","2004-Q4","2007-Q2",
"2009-Q4","2012-Q2","2014-Q4","2017-Q2","2019-Q4"))
```

```{r}
plot(Data5$REER_gap, type = "line", xaxt = "n", xlab = NA, ylab = "REER gap")
abline(h = 0, col = "black")
axis(1, las = 2, at = c(0,10,20,30,40,50,60,70,80),labels = c("2000-Q1","2002-Q2","2004-Q4","2007-Q2",
"2009-Q4","2012-Q2","2014-Q4","2017-Q2","2019-Q4"))

```

```{r}
#Autoregressive Markov Switching Model

#new data set
Data_HMM = as.data.frame(Data5)

#First order difference
Data_HMM$diff_IR3T = c(0, diff(Data_HMM$IR3T_geomean))

Data_HMM = (subset(Data_HMM, select = c(diff_IR3T, inf_gap, output_gap, REER_gap)))

#As time series
Data_HMM_ts = as.ts(Data_HMM)

HMM2 = lm(diff_IR3T ~ -1 + inf_gap + output_gap + REER_gap, data = Data_HMM_ts, na.action=na.exclude)
```

```{r}
#Determining correct number of lags for HMM

order = 1:10

BICs = sapply(order, function(x) 
        "AR" = BIC(dynlm(ts(Data_HMM$REER_gap) ~ L(ts(Data_HMM$REER_gap), 1:x))))
BICs

AICs = sapply(order, function(x) 
        "AR" = AIC(dynlm(ts(Data_HMM$REER_gap) ~ L(ts(Data_HMM$REER_gap), 1:x))))
AICs

pacf(Data_HMM$inf_gap, lag.max = 5)

#1 lag

pacf(Data_HMM$output_gap, lag.max = 5)

#1 lag

pacf(Data_HMM$REER_gap, lag.max = 30)

#Suspected issue with seasonality (pacf plot shows spike in lag 3 = 1 year in quarters) but cannot decompose.
#Problem averted, seasonality probability low with extended pacf plot

#0 lag
```

```{r}
#HMM fitted with interest rate smoothing
model_HMM1 = msmFit(HMM2, k = 2, sw = c(T,T,T,F,T), p = 1)

summary(model_HMM1)

#plotting smoothed and filtered probabilities
plotProb(model_HMM1, which = 1)
axis(1, las = 2, at = c(0,10,20,30,40,50,60,70,80),labels = c("2000-Q1","2002-Q2","2004-Q4","2007-Q2",
"2009-Q4","2012-Q2","2014-Q4","2017-Q2","2019-Q4"))
```

```{r}
#State-Space Model

#New data set for SSM
Data_SSM = as.data.frame(Data5)

Data_SSM_xts = xts(Data_SSM, order.by = as.Date(Data_SSM$date))

#Defining variables
y = ts(as.vector(as.numeric(Data_SSM_xts$IR3T_geomean)))

x1 = ts(as.numeric(Data_SSM_xts$inf_gap))
x2 = ts(as.numeric(Data_SSM_xts$output_gap))
x3 = ts(as.numeric(Data_SSM_xts$REER_gap))

#Model estimation and specification
model1 = SSModel(y ~ -1 + SSMregression(~ x1 + x2 + x3, type = "common", Q=(diag(1, nrow=3, ncol=3))))

smooth_states = coef(model1, states = "regression")

#Confirming model
is.SSModel(model1)

#Alternative coefficient extraction (same results)
out_model1 = KFS(model1, smoothing = c("state", "mean", "disturbance"))

smooth_kfs = coef(out_model1, states = "regression")

#Removing atomic vectors
smooth_states1 = as.data.frame(smooth_states)
```

```{r}
#Extracting residuals from the smooth states

#Normal state residuals
res_outmodel = residuals(out_model1, type = c("state"))
mse = mean(res_outmodel^2)

#Computing RMSE traditional way
rmse = sqrt(mse)

#Constructing confidence intervals
up_x1 = (smooth_states1[,1] + (2*rmse))
low_x1 = (smooth_states1[,1] - (2*rmse))

up_x2 = (smooth_states1[,2] + (2*rmse))
low_x2 = (smooth_states1[,2] - (2*rmse))

up_x3 = (smooth_states1[,3] + (2*rmse))
low_x3 = (smooth_states1[,3] - (2*rmse))

#Preparing graphs for states with CIs
state_CIs1 = as.data.frame(cbind(smooth_states1[,1], up_x1, low_x1))
state_CIs2 = as.data.frame(cbind(smooth_states1[,2], up_x2, low_x2))
state_CIs3 = as.data.frame(cbind(smooth_states1[,3], up_x3, low_x3))
```

```{r}
#Smooth state inflation gap
plot(state_CIs1[,1], type = "line", xaxt = "n", 
     xlab = NA, ylab = "Beta Inflation gap", ylim = c(-5, 6))
lines(state_CIs1$up_x1, lty = 'dashed', col = 'blue')
lines(state_CIs1$low_x1, lty = 'dashed', col = 'blue')
abline(h = 0, col = "black")
axis(1, las = 2, at = c(0,10,20,30,40,50,60,70,80),labels = c("2000-Q1","2002-Q2","2004-Q4","2007-Q2",
"2009-Q4","2012-Q2","2014-Q4","2017-Q2","2019-Q4"))
```

```{r}
#Smooth state output gap

plot(state_CIs2[,1], type = "line", xaxt = "n", 
     xlab = NA, ylab = "Beta Output gap", ylim = c(-5, 5))
lines(state_CIs2$up_x2, lty = 'dashed', col = 'blue')
lines(state_CIs2$low_x2, lty = 'dashed', col = 'blue')
abline(h = 0, col = "black")
axis(1, las = 2, at = c(0,10,20,30,40,50,60,70,80),labels = c("2000-Q1","2002-Q2","2004-Q4","2007-Q2",
"2009-Q4","2012-Q2","2014-Q4","2017-Q2","2019-Q4"))
```

```{r}
#Smooth state REER gap

plot(state_CIs3[,1], type = "line", xaxt = "n", 
     xlab = NA, ylab = "Beta REER gap", ylim = c(-5, 6))
lines(state_CIs3$up_x3, lty = 'dashed', col = 'blue')
lines(state_CIs3$low_x3, lty = 'dashed', col = 'blue')
abline(h = 0, col = "black")
axis(1, las = 2, at = c(0,10,20,30,40,50,60,70,80),labels = c("2000-Q1","2002-Q2","2004-Q4","2007-Q2",
"2009-Q4","2012-Q2","2014-Q4","2017-Q2","2019-Q4"))
```

```{r}
inf_average = mean(Data1$core_inf)

inf_average

```

```{r}
#Extracting HMM conditional residuals
HMM1_resid = msmResid(model_HMM1)

#Extracting HMM regime unconditional residuals
HMM1_resid1 = msmResid(model_HMM1, 1)
HMM1_resid2 = msmResid(model_HMM1, 2)

#Plotting all residuals
plot(model_HMM1)
```

```{r}
#Post estimation normality tests of smooth state residuals SS model
res_outmodel_ts = ts(res_outmodel)

#Ljung-box tests, H0 = no autocorrelation

Box.test(res_outmodel_ts[,1], type = "Ljung-Box")
#Autocorrelation

Box.test(res_outmodel_ts[,2], type = "Ljung-Box")
#Autocorrelation

Box.test(res_outmodel_ts[,3], type = "Ljung-Box")
#Autocorrelation


#Jarque-Bera tests, normal, H0 = normal distribution
jarque.bera.test(res_outmodel_ts[,1])
#Normally distributed 

jarque.bera.test(res_outmodel_ts[,2])
#Normally distributed

jarque.bera.test(res_outmodel_ts[,3])
#Not normally distributed

plot(res_outmodel_ts[,1])
plot(res_outmodel_ts[,2])
plot(res_outmodel_ts[,3])

#Normality tests of HMM

#Conditional residuals
jarque.bera.test(HMM1_resid)
#Not normally distributed

#Residuals regime1
jarque.bera.test(HMM1_resid1)
#Normally distributed

#Residuals regime2
jarque.bera.test(HMM1_resid2)
#Not normally distributed
```
